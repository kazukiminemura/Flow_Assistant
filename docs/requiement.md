
# フロー・アシスタント（Flow Assistant）要件定義書

**版**: v1.0  
**作成日**: 2025-09-27  
**対象**: AIPC（NPU搭載PC／Windows 11想定）

---

## 1. 目的・ビジョン
- PCが人間の行動を“先回り”して支援することで、生産性・集中力・創造性を高める。  
- アプリ横断で文脈を把握し、提案 → ユーザー選択 → 学習 → 振り返り、のサイクルを確立する。  
- クラウドに依存せず、オンデバイスでプライバシーと低遅延を両立する。

---

## 2. 機能要件

### F1. 作業文脈の自動把握
- アクティブアプリ、ファイル、ブラウザタブ、会議内容を自動取得。  
- NPUで要約・埋め込みを生成し、ローカルインデックスに蓄積。

### F2. 先回りの気づき
- 行動をルール/学習器で予測し、提案を生成。  
- 提案例:  
  - データ編集中 → 「グラフにまとめますか？」  
  - 会議で数値話題 → 「関連売上資料を開きますか？」  
  - APIコーディング中 → 「公式ドキュメント参照はこちら」  

### F3. 人間と共同判断
- 提案は「アシストカード」として表示。  
- 選択肢: 採用 / 無視 / 修正 / 後で。  
- 採用すると実行（例: グラフ生成、資料表示）、学習して精度向上。

### F4. 継続的なリフレクション
- 日次: 「提案数・採用率・時間削減推定」を自動レポート化。  
- 週次: よく使う提案、ノイズ提案、改善提案を提示。  

---

## 3. 非機能要件
- **性能**: 提案表示 ≤800ms、要約処理 ≤2秒/1,000字。  
- **省電力**: バッテリ駆動8時間で消費電力量+5%以内。  
- **セキュリティ**: 原文保存OFF既定、出典表示必須、外部送信ゼロ。  
- **透明性**: 提案の根拠（出典・抜粋）を常に提示。  
- **拡張性**: 新アプリ/コネクタを容易に追加可能。  

---

## 4. データモデル
- **Document**: `doc_id, path/url, title, summary, embedding, updated_at`  
- **Context Snapshot**: `ts, app, window_title, selected_text, participants`  
- **Suggestion**: `sid, ts, type, payload, sources[], score`  
- **Episode**: `eid, sid, user_action, result_status, rollback_ref`  

---

## 5. システム構成
```mermaid
flowchart LR
  A[Collector] --> B[Preprocessor(NPU)]
  B --> C[Index: SQLite+Vector]
  D[Trigger Engine] -->|Context Pull| C
  D --> E[RAG Engine]
  E --> F[Card UI]
  F -->|採用/修正| G[Action Executor]
  F -->|ログ| H[Learning]
  H --> D
  C --> I[Report Builder]

## 6. 権限・プライバシー
- **デフォルトOFF**: ブラウザ拡張・音声解析  
- **除外設定**: フォルダ / ドメイン / アプリごとに除外可能  
- **保持期間**: デフォルト30日、自動削除可  
- **監査ログ**: 出典と提案の理由を全件記録  

---

## 7. 初期ルール例

| トリガ       | 条件               | 提案                 | 実行例              |
|--------------|--------------------|----------------------|---------------------|
| Excel保存    | 数表/日付列を検出  | グラフ化（棒/折れ線/散布） | 一時Excelを生成     |
| ブラウザ選択 | 固有名詞検出       | 関連資料提示         | 上位5件を開く       |
| VSCode編集   | 同名関数を複数編集 | 類似修正/Issue提示   | Gitログ参照         |
| PDF契約書    | 期日/金額抽出      | ToDo/カレンダー作成  | ICSドラフト出力     |

---

## 8. 成功指標
- **採用率**: ≥40%  
- **誤提案**: ≤5%/h  
- **操作削減効果**: 平均クリック数 -30%  
- **日次レポ利用率**: ≥70%  

  
  
